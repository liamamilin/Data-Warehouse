<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 数仓规范建设指南 | Data Warehouse</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 数仓规范建设指南 | Data Warehouse" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 数仓规范建设指南 | Data Warehouse" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="米霖" />


<meta name="date" content="2023-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="搭建数据仓库.html"/>
<link rel="next" href="其他一些内容.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Warehouse</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> url: your book url like https://bookdown.org/yihui/bookdown</a></li>
<li class="chapter" data-level="2" data-path="数据仓库的基本概念.html"><a href="数据仓库的基本概念.html"><i class="fa fa-check"></i><b>2</b> 数据仓库的基本概念</a>
<ul>
<li class="chapter" data-level="2.1" data-path="数据仓库的基本概念.html"><a href="数据仓库的基本概念.html#数仓架构"><i class="fa fa-check"></i><b>2.1</b> 数仓架构</a></li>
<li class="chapter" data-level="2.2" data-path="数据仓库的基本概念.html"><a href="数据仓库的基本概念.html#数据仓库基本概念"><i class="fa fa-check"></i><b>2.2</b> 数据仓库基本概念</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="数据仓库的基本概念.html"><a href="数据仓库的基本概念.html#基本特征"><i class="fa fa-check"></i><b>2.2.1</b> <strong>基本特征</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="数据仓库的基本概念.html"><a href="数据仓库的基本概念.html#为什么要有数据仓库"><i class="fa fa-check"></i><b>2.3</b> 为什么要有数据仓库</a></li>
<li class="chapter" data-level="2.4" data-path="数据仓库的基本概念.html"><a href="数据仓库的基本概念.html#数据仓库与数据库的区别"><i class="fa fa-check"></i><b>2.4</b> 数据仓库与数据库的区别</a></li>
<li class="chapter" data-level="2.5" data-path="数据仓库的基本概念.html"><a href="数据仓库的基本概念.html#数据仓库分层架构"><i class="fa fa-check"></i><b>2.5</b> <strong>数据仓库分层架构</strong></a></li>
<li class="chapter" data-level="2.6" data-path="数据仓库的基本概念.html"><a href="数据仓库的基本概念.html#数据仓库架构"><i class="fa fa-check"></i><b>2.6</b> 数据仓库架构</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="数据仓库的基本概念.html"><a href="数据仓库的基本概念.html#数据集市架构"><i class="fa fa-check"></i><b>2.6.1</b> <strong>数据集市架构</strong></a></li>
<li class="chapter" data-level="2.6.2" data-path="数据仓库的基本概念.html"><a href="数据仓库的基本概念.html#inmon企业工厂架构"><i class="fa fa-check"></i><b>2.6.2</b> <strong>Inmon企业工厂架构</strong></a></li>
<li class="chapter" data-level="2.6.3" data-path="数据仓库的基本概念.html"><a href="数据仓库的基本概念.html#kimball数据仓库架构"><i class="fa fa-check"></i><b>2.6.3</b> <strong>Kimball数据仓库架构</strong></a></li>
<li class="chapter" data-level="2.6.4" data-path="数据仓库的基本概念.html"><a href="数据仓库的基本概念.html#混合型数据仓库架构"><i class="fa fa-check"></i><b>2.6.4</b> <strong>混合型数据仓库架构</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="数据仓库的基本概念.html"><a href="数据仓库的基本概念.html#数据仓库元数据的管理"><i class="fa fa-check"></i><b>2.7</b> <strong>数据仓库元数据的管理</strong></a></li>
<li class="chapter" data-level="2.8" data-path="数据仓库的基本概念.html"><a href="数据仓库的基本概念.html#数仓常见术语解析"><i class="fa fa-check"></i><b>2.8</b> <strong>数仓常见术语解析</strong></a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="数据仓库的基本概念.html"><a href="数据仓库的基本概念.html#数仓名词解释"><i class="fa fa-check"></i><b>2.8.1</b> <strong>数仓名词解释</strong></a></li>
<li class="chapter" data-level="2.8.2" data-path="数据仓库的基本概念.html"><a href="数据仓库的基本概念.html#数仓名词之间关系"><i class="fa fa-check"></i><b>2.8.2</b> <strong>数仓名词之间关系</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="离线数仓建设核心.html"><a href="离线数仓建设核心.html"><i class="fa fa-check"></i><b>3</b> <strong>离线数仓建设核心</strong></a>
<ul>
<li class="chapter" data-level="3.1" data-path="离线数仓建设核心.html"><a href="离线数仓建设核心.html#数仓分层"><i class="fa fa-check"></i><b>3.1</b> <strong>数仓分层</strong></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="离线数仓建设核心.html"><a href="离线数仓建设核心.html#数据源层odsoperational-data-store"><i class="fa fa-check"></i><b>3.1.1</b> <strong>数据源层：ODS（Operational Data Store）</strong></a></li>
<li class="chapter" data-level="3.1.2" data-path="离线数仓建设核心.html"><a href="离线数仓建设核心.html#数据仓库层dwdata-warehouse"><i class="fa fa-check"></i><b>3.1.2</b> <strong>数据仓库层：DW（Data Warehouse）</strong></a></li>
<li class="chapter" data-level="3.1.3" data-path="离线数仓建设核心.html"><a href="离线数仓建设核心.html#数据应用层appapplication"><i class="fa fa-check"></i><b>3.1.3</b> <strong>数据应用层：APP（Application）</strong></a></li>
<li class="chapter" data-level="3.1.4" data-path="离线数仓建设核心.html"><a href="离线数仓建设核心.html#维表层dimdimension"><i class="fa fa-check"></i><b>3.1.4</b> <strong>维表层：DIM（Dimension）</strong></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="离线数仓建设核心.html"><a href="离线数仓建设核心.html#数仓建模方法"><i class="fa fa-check"></i><b>3.2</b> <strong>数仓建模方法</strong></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="离线数仓建设核心.html"><a href="离线数仓建设核心.html#范式建模法third-normal-form3nf"><i class="fa fa-check"></i><b>3.2.1</b> <strong>范式建模法（Third Normal Form，3NF）</strong></a></li>
<li class="chapter" data-level="3.2.2" data-path="离线数仓建设核心.html"><a href="离线数仓建设核心.html#维度建模法dimensional-modeling"><i class="fa fa-check"></i><b>3.2.2</b> <strong>维度建模法（Dimensional Modeling）</strong></a></li>
<li class="chapter" data-level="3.2.3" data-path="离线数仓建设核心.html"><a href="离线数仓建设核心.html#实体建模法entity-modeling"><i class="fa fa-check"></i><b>3.2.3</b> <strong>实体建模法（Entity Modeling）</strong></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="离线数仓建设核心.html"><a href="离线数仓建设核心.html#维度建模详解"><i class="fa fa-check"></i><b>3.3</b> <strong>维度建模详解</strong></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="离线数仓建设核心.html"><a href="离线数仓建设核心.html#维度建模中表的类型"><i class="fa fa-check"></i><b>3.3.1</b> <strong>维度建模中表的类型</strong></a></li>
<li class="chapter" data-level="3.3.2" data-path="离线数仓建设核心.html"><a href="离线数仓建设核心.html#事实表"><i class="fa fa-check"></i><b>3.3.2</b> <strong>事实表</strong></a></li>
<li class="chapter" data-level="3.3.3" data-path="离线数仓建设核心.html"><a href="离线数仓建设核心.html#维度表"><i class="fa fa-check"></i><b>3.3.3</b> 维度表</a></li>
<li class="chapter" data-level="3.3.4" data-path="离线数仓建设核心.html"><a href="离线数仓建设核心.html#维度建模三种模式"><i class="fa fa-check"></i><b>3.3.4</b> 维度建模三种模式</a></li>
<li class="chapter" data-level="3.3.5" data-path="离线数仓建设核心.html"><a href="离线数仓建设核心.html#维度建模过程"><i class="fa fa-check"></i><b>3.3.5</b> 维度建模过程</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="离线数仓建设.html"><a href="离线数仓建设.html"><i class="fa fa-check"></i><b>4</b> 离线数仓建设</a>
<ul>
<li class="chapter" data-level="4.1" data-path="离线数仓建设.html"><a href="离线数仓建设.html#业务理解"><i class="fa fa-check"></i><b>4.1</b> 业务理解</a></li>
<li class="chapter" data-level="4.2" data-path="离线数仓建设.html"><a href="离线数仓建设.html#早期规划"><i class="fa fa-check"></i><b>4.2</b> 早期规划</a></li>
<li class="chapter" data-level="4.3" data-path="离线数仓建设.html"><a href="离线数仓建设.html#数据中台"><i class="fa fa-check"></i><b>4.3</b> 数据中台</a></li>
<li class="chapter" data-level="4.4" data-path="离线数仓建设.html"><a href="离线数仓建设.html#数仓建设"><i class="fa fa-check"></i><b>4.4</b> 数仓建设</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="离线数仓建设.html"><a href="离线数仓建设.html#模型"><i class="fa fa-check"></i><b>4.4.1</b> 模型</a></li>
<li class="chapter" data-level="4.4.2" data-path="离线数仓建设.html"><a href="离线数仓建设.html#模型分层"><i class="fa fa-check"></i><b>4.4.2</b> 模型分层</a></li>
<li class="chapter" data-level="4.4.3" data-path="离线数仓建设.html"><a href="离线数仓建设.html#数据流向"><i class="fa fa-check"></i><b>4.4.3</b> 数据流向</a></li>
<li class="chapter" data-level="4.4.4" data-path="离线数仓建设.html"><a href="离线数仓建设.html#规范"><i class="fa fa-check"></i><b>4.4.4</b> 规范</a></li>
<li class="chapter" data-level="4.4.5" data-path="离线数仓建设.html"><a href="离线数仓建设.html#数据层具体实现"><i class="fa fa-check"></i><b>4.4.5</b> 数据层具体实现</a></li>
<li class="chapter" data-level="4.4.6" data-path="离线数仓建设.html"><a href="离线数仓建设.html#总结"><i class="fa fa-check"></i><b>4.4.6</b> 总结</a></li>
<li class="chapter" data-level="4.4.7" data-path="离线数仓建设.html"><a href="离线数仓建设.html#实际生产中注意事项"><i class="fa fa-check"></i><b>4.4.7</b> 实际生产中注意事项</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="实时计算.html"><a href="实时计算.html"><i class="fa fa-check"></i><b>5</b> 实时计算</a>
<ul>
<li class="chapter" data-level="5.1" data-path="实时计算.html"><a href="实时计算.html#实时计算应用场景"><i class="fa fa-check"></i><b>5.1</b> 实时计算应用场景</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="实时计算.html"><a href="实时计算.html#实时智能推荐"><i class="fa fa-check"></i><b>5.1.1</b> 实时智能推荐</a></li>
<li class="chapter" data-level="5.1.2" data-path="实时计算.html"><a href="实时计算.html#实时欺诈检测"><i class="fa fa-check"></i><b>5.1.2</b> 实时欺诈检测</a></li>
<li class="chapter" data-level="5.1.3" data-path="实时计算.html"><a href="实时计算.html#舆情分析"><i class="fa fa-check"></i><b>5.1.3</b> 舆情分析</a></li>
<li class="chapter" data-level="5.1.4" data-path="实时计算.html"><a href="实时计算.html#复杂事件处理"><i class="fa fa-check"></i><b>5.1.4</b> 复杂事件处理</a></li>
<li class="chapter" data-level="5.1.5" data-path="实时计算.html"><a href="实时计算.html#实时机器学习"><i class="fa fa-check"></i><b>5.1.5</b> 实时机器学习</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="实时计算.html"><a href="实时计算.html#实时计算总览"><i class="fa fa-check"></i><b>5.2</b> 实时计算总览</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="实时计算.html"><a href="实时计算.html#数据同步"><i class="fa fa-check"></i><b>5.2.1</b> 数据同步：</a></li>
<li class="chapter" data-level="5.2.2" data-path="实时计算.html"><a href="实时计算.html#数据存储"><i class="fa fa-check"></i><b>5.2.2</b> 数据存储：</a></li>
<li class="chapter" data-level="5.2.3" data-path="实时计算.html"><a href="实时计算.html#数据计算"><i class="fa fa-check"></i><b>5.2.3</b> 数据计算：</a></li>
<li class="chapter" data-level="5.2.4" data-path="实时计算.html"><a href="实时计算.html#实时应用"><i class="fa fa-check"></i><b>5.2.4</b> 实时应用：</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="实时计算.html"><a href="实时计算.html#实时架构"><i class="fa fa-check"></i><b>5.3</b> 实时架构</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="实时计算.html"><a href="实时计算.html#lambda架构"><i class="fa fa-check"></i><b>5.3.1</b> Lambda架构</a></li>
<li class="chapter" data-level="5.3.2" data-path="实时计算.html"><a href="实时计算.html#为什么lambda架构要分成两条线计算"><i class="fa fa-check"></i><b>5.3.2</b> 为什么Lambda架构要分成两条线计算？</a></li>
<li class="chapter" data-level="5.3.3" data-path="实时计算.html"><a href="实时计算.html#lambda架构有没有缺点"><i class="fa fa-check"></i><b>5.3.3</b> Lambda架构有没有缺点</a></li>
<li class="chapter" data-level="5.3.4" data-path="实时计算.html"><a href="实时计算.html#kappa架构"><i class="fa fa-check"></i><b>5.3.4</b> Kappa架构</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="实时数仓建设.html"><a href="实时数仓建设.html"><i class="fa fa-check"></i><b>6</b> 实时数仓建设</a>
<ul>
<li class="chapter" data-level="6.1" data-path="实时数仓建设.html"><a href="实时数仓建设.html#实时计算初期"><i class="fa fa-check"></i><b>6.1</b> 实时计算初期</a></li>
<li class="chapter" data-level="6.2" data-path="实时数仓建设.html"><a href="实时数仓建设.html#实时数仓建设-1"><i class="fa fa-check"></i><b>6.2</b> 实时数仓建设</a></li>
<li class="chapter" data-level="6.3" data-path="实时数仓建设.html"><a href="实时数仓建设.html#lambda架构的实时数仓"><i class="fa fa-check"></i><b>6.3</b> Lambda架构的实时数仓</a></li>
<li class="chapter" data-level="6.4" data-path="实时数仓建设.html"><a href="实时数仓建设.html#kappa架构的实时数仓"><i class="fa fa-check"></i><b>6.4</b> Kappa架构的实时数仓</a></li>
<li class="chapter" data-level="6.5" data-path="实时数仓建设.html"><a href="实时数仓建设.html#流批结合的实时数仓"><i class="fa fa-check"></i><b>6.5</b> 流批结合的实时数仓</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="搭建数据仓库.html"><a href="搭建数据仓库.html"><i class="fa fa-check"></i><b>7</b> 搭建数据仓库</a>
<ul>
<li class="chapter" data-level="7.1" data-path="搭建数据仓库.html"><a href="搭建数据仓库.html#基于flink-sql从0到1构建一个实时数仓"><i class="fa fa-check"></i><b>7.1</b> 基于Flink SQL从0到1构建一个实时数仓</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="搭建数据仓库.html"><a href="搭建数据仓库.html#架构设计"><i class="fa fa-check"></i><b>7.1.1</b> 架构设计</a></li>
<li class="chapter" data-level="7.1.2" data-path="搭建数据仓库.html"><a href="搭建数据仓库.html#业务数据准备"><i class="fa fa-check"></i><b>7.1.2</b> 业务数据准备</a></li>
<li class="chapter" data-level="7.1.3" data-path="搭建数据仓库.html"><a href="搭建数据仓库.html#数据处理流程"><i class="fa fa-check"></i><b>7.1.3</b> 数据处理流程</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html"><i class="fa fa-check"></i><b>8</b> 数仓规范建设指南</a>
<ul>
<li class="chapter" data-level="8.1" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#数仓公共开发规范"><i class="fa fa-check"></i><b>8.1</b> 数仓公共开发规范</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#层次调用规范"><i class="fa fa-check"></i><b>8.1.1</b> 层次调用规范</a></li>
<li class="chapter" data-level="8.1.2" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#数据类型规范"><i class="fa fa-check"></i><b>8.1.2</b> 数据类型规范</a></li>
<li class="chapter" data-level="8.1.3" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#数据冗余规范"><i class="fa fa-check"></i><b>8.1.3</b> 数据冗余规范</a></li>
<li class="chapter" data-level="8.1.4" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#null字段处理规范"><i class="fa fa-check"></i><b>8.1.4</b> NULL字段处理规范</a></li>
<li class="chapter" data-level="8.1.5" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#指标口径规范"><i class="fa fa-check"></i><b>8.1.5</b> 指标口径规范</a></li>
<li class="chapter" data-level="8.1.6" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#数据表处理规范"><i class="fa fa-check"></i><b>8.1.6</b> 数据表处理规范</a></li>
<li class="chapter" data-level="8.1.7" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#表的生命周期管理"><i class="fa fa-check"></i><b>8.1.7</b> 表的生命周期管理</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#数仓各层开发规范"><i class="fa fa-check"></i><b>8.2</b> 数仓各层开发规范</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#ods层设计规范"><i class="fa fa-check"></i><b>8.2.1</b> ODS层设计规范</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#公共维度层设计规范"><i class="fa fa-check"></i><b>8.3</b> 公共维度层设计规范</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#设计准则"><i class="fa fa-check"></i><b>8.3.1</b> 设计准则</a></li>
<li class="chapter" data-level="8.3.2" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#dwd明细层设计规范"><i class="fa fa-check"></i><b>8.3.2</b> DWD明细层设计规范</a></li>
<li class="chapter" data-level="8.3.3" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#dws公共汇总层设计规范"><i class="fa fa-check"></i><b>8.3.3</b> DWS公共汇总层设计规范</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#数仓命名规范"><i class="fa fa-check"></i><b>8.4</b> 数仓命名规范</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#词根设计规范"><i class="fa fa-check"></i><b>8.4.1</b> 词根设计规范</a></li>
<li class="chapter" data-level="8.4.2" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#数仓表的命名规范如下"><i class="fa fa-check"></i><b>8.4.2</b> 数仓表的命名规范如下：</a></li>
<li class="chapter" data-level="8.4.3" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#表命名规范"><i class="fa fa-check"></i><b>8.4.3</b> 表命名规范</a></li>
<li class="chapter" data-level="8.4.4" data-path="数仓规范建设指南.html"><a href="数仓规范建设指南.html#指标命名规范"><i class="fa fa-check"></i><b>8.4.4</b> 指标命名规范</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="其他一些内容.html"><a href="其他一些内容.html"><i class="fa fa-check"></i><b>9</b> 其他一些内容</a>
<ul>
<li class="chapter" data-level="9.1" data-path="其他一些内容.html"><a href="其他一些内容.html#数据仓库开发挂件角色"><i class="fa fa-check"></i><b>9.1</b> 数据仓库开发挂件角色</a></li>
<li class="chapter" data-level="9.2" data-path="其他一些内容.html"><a href="其他一些内容.html#数据仓库开发需要掌握的技能"><i class="fa fa-check"></i><b>9.2</b> 数据仓库开发需要掌握的技能</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="其他一些内容.html"><a href="其他一些内容.html#如何额进行elt"><i class="fa fa-check"></i><b>9.2.1</b> 如何额进行ELT</a></li>
<li class="chapter" data-level="9.2.2" data-path="其他一些内容.html"><a href="其他一些内容.html#一个简单的etl例子"><i class="fa fa-check"></i><b>9.2.2</b> 一个简单的ETL例子</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Warehouse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="数仓规范建设指南" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> 数仓规范建设指南<a href="数仓规范建设指南.html#数仓规范建设指南" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="数仓公共开发规范" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> 数仓公共开发规范<a href="数仓规范建设指南.html#数仓公共开发规范" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="层次调用规范" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> 层次调用规范<a href="数仓规范建设指南.html#层次调用规范" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>稳定业务按照标准的数据流向进行开发，即 ODS –&gt; DWD –&gt; DWS –&gt; APP。非稳定业务或探索性需求，可以遵循 ODS -&gt; DWD -&gt; APP 或者 ODS -&gt; DWD -&gt; DWM -&gt;APP 两个模型数据流。</p>
<p>在保障了数据链路的合理性之后，也必须保证模型分层引用原则：</p>
<ul>
<li>正常流向：ODS -&gt; DWD -&gt; DWM -&gt; DWS -&gt; APP，当出现 ODS -&gt; DWD -&gt; DWS -&gt; APP 这种关系时，说明主题域未覆盖全。应将 DWD 数据落到 DWM 中，对于使用频度非常低的表允许 DWD -&gt; DWS。</li>
<li>尽量避免出现 DWS 宽表中使用 DWD 又使用（该 DWD 所归属主题域）DWM 的表。</li>
<li>同一主题域内对于 DWM 生成 DWM 的表，原则上要尽量避免，否则会影响 ETL 的效率。</li>
<li>DWM、DWS 和 APP 中禁止直接使用 ODS 的表， ODS 的表只能被 DWD 引用。</li>
<li>禁止出现反向依赖，例如 DWM 的表依赖 DWS 的表。</li>
</ul>
<p><img src="https://pic1.zhimg.com/80/v2-bcfb69a6a177387e73ea19247bf2da66_1440w.png" /></p>
</div>
<div id="数据类型规范" class="section level3 hasAnchor" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> 数据类型规范<a href="数仓规范建设指南.html#数据类型规范" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>需统一规定不同的数据的数据类型，严格按照规定的数据类型执行：</p>
<ul>
<li>金额：double 或使用 decimal(11,2) 控制精度等，明确单位是分还是元。</li>
<li>字符串：string。</li>
<li>id类：bigint。</li>
<li>时间：string。</li>
<li>状态：string</li>
</ul>
</div>
<div id="数据冗余规范" class="section level3 hasAnchor" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> 数据冗余规范<a href="数仓规范建设指南.html#数据冗余规范" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>宽表的冗余字段要确保：</p>
<ul>
<li>冗余字段要使用高频，下游3个或以上使用。</li>
<li>冗余字段引入不应造成本身数据产生过多的延后。</li>
<li>冗余字段和已有字段的重复率不应过大，原则上不应超过60%，如需要可以选择join或原表拓展。</li>
</ul>
</div>
<div id="null字段处理规范" class="section level3 hasAnchor" number="8.1.4">
<h3><span class="header-section-number">8.1.4</span> NULL字段处理规范<a href="数仓规范建设指南.html#null字段处理规范" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>对于维度字段，需设置为-1</li>
<li>对于指标字段，需设置为 0</li>
</ul>
</div>
<div id="指标口径规范" class="section level3 hasAnchor" number="8.1.5">
<h3><span class="header-section-number">8.1.5</span> 指标口径规范<a href="数仓规范建设指南.html#指标口径规范" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>保证主题域内，指标口径一致，无歧义。</p>
<p>通过数据分层，提供统一的数据出口，统一对外输出的数据口径，避免同一指标不同口径的情况发生。</p>
<div id="指标梳理" class="section level4 hasAnchor" number="8.1.5.1">
<h4><span class="header-section-number">8.1.5.1</span> 指标梳理<a href="数仓规范建设指南.html#指标梳理" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>指标口径的不一致使得数据使用的成本极高，经常出现口径打架、反复核对数据的问题。在数据治理中，我们将需求梳理到的所有指标进行进一步梳理，明确其口径，如果存在两个指标名称相同，但口径不一致，先判断是否是进行合并，如需要同时存在，那么在命名上必须能够区分开。</p>
</div>
<div id="指标管理" class="section level4 hasAnchor" number="8.1.5.2">
<h4><span class="header-section-number">8.1.5.2</span> 指标管理<a href="数仓规范建设指南.html#指标管理" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>指标管理分为原子指标维护和派生指标维护。</p>
<p>原子指标：</p>
<ul>
<li>选择原子指标的归属产线、业务板块、数据域、业务过程</li>
<li>选择原子指标的统计数据来源于该业务过程下的原始数据源</li>
<li>录入原子指标的英文名称、中文名称、概述</li>
<li>填写指标函数</li>
<li>系统根据指标函数自动生成原子指标的定义表达式</li>
<li>系统根据指标定义表达式以及数据源表生成原子指标SQL</li>
</ul>
<p>派生指标：</p>
<p>在原子指标的基础之上选择了一些维度或者修饰限定词。</p>
</div>
</div>
<div id="数据表处理规范" class="section level3 hasAnchor" number="8.1.6">
<h3><span class="header-section-number">8.1.6</span> 数据表处理规范<a href="数仓规范建设指南.html#数据表处理规范" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="增量表" class="section level4 hasAnchor" number="8.1.6.1">
<h4><span class="header-section-number">8.1.6.1</span> 增量表<a href="数仓规范建设指南.html#增量表" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>新增数据，增量数据是上次导出之后的新数据。</p>
<ul>
<li>记录每次增加的量，而不是总量；</li>
<li>增量表，只报变化量，无变化不用报；</li>
<li>每天一个分区。</li>
</ul>
</div>
<div id="全量表" class="section level4 hasAnchor" number="8.1.6.2">
<h4><span class="header-section-number">8.1.6.2</span> 全量表<a href="数仓规范建设指南.html#全量表" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>每天的所有的最新状态的数据。</p>
<ul>
<li>全量表，有无变化，都要报；</li>
<li>每次上报的数据都是所有的数据（变化的 + 没有变化的）；</li>
<li>只有一个分区。</li>
</ul>
</div>
<div id="快照表" class="section level4 hasAnchor" number="8.1.6.3">
<h4><span class="header-section-number">8.1.6.3</span> 快照表<a href="数仓规范建设指南.html#快照表" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>按日分区，记录截止数据日期的全量数据。</p>
<ul>
<li>快照表，有无变化，都要报；</li>
<li>每次上报的数据都是所有的数据（变化的 + 没有变化的）；</li>
<li>一天一个分区。</li>
</ul>
</div>
<div id="拉链表" class="section level4 hasAnchor" number="8.1.6.4">
<h4><span class="header-section-number">8.1.6.4</span> 拉链表<a href="数仓规范建设指南.html#拉链表" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>记录截止数据日期的全量数据。</p>
<ul>
<li>记录一个事物从开始，一直到当前状态的所有变化的信息；</li>
<li>拉链表每次上报的都是历史记录的最终状态，是记录在当前时刻的历史总 量；</li>
<li>当前记录存的是当前时间之前的所有历史记录的最后变化量（总量）；</li>
<li>只有一个分区。</li>
</ul>
</div>
</div>
<div id="表的生命周期管理" class="section level3 hasAnchor" number="8.1.7">
<h3><span class="header-section-number">8.1.7</span> 表的生命周期管理<a href="数仓规范建设指南.html#表的生命周期管理" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>这部分主要是要通过对历史数据的等级划分与对表类型的划分生成相应的生命周期管理矩阵。</p>
<div id="历史数据等级划分" class="section level4 hasAnchor" number="8.1.7.1">
<h4><span class="header-section-number">8.1.7.1</span> 历史数据等级划分<a href="数仓规范建设指南.html#历史数据等级划分" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>主要将历史数据划分P0、Pl、P2、P3 四个等级，其具体定义如下：</p>
<ul>
<li>P0 ：非常重要的主题域数据和非常重要的应用数据，具有不可恢复性，如交易、日志、集团 KPI 数据、 IPO 关联表。</li>
<li>Pl ：重要的业务数据和重要的应用数据，具有不可恢复性，如重要的业务产品数据。</li>
<li>P2 ：重要的业务数据和重要的应用数据，具有可恢复性，如交易线 ETL 产生的中间过程数据。</li>
<li>P3 ：不重要的业务数据和不重要的应用数据，具有可恢复性，如某些 SNS 产品报表。</li>
</ul>
</div>
<div id="表类型划分" class="section level4 hasAnchor" number="8.1.7.2">
<h4><span class="header-section-number">8.1.7.2</span> 表类型划分<a href="数仓规范建设指南.html#表类型划分" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>事件型流水表（增量表）</li>
</ol>
<p>事件型流水表（增量表）指数据无重复或者无主键数据，如日志。</p>
<ol start="2" style="list-style-type: decimal">
<li>事件型镜像表（增量表）</li>
</ol>
<p>事件型镜像表（增量表）指业务过程性数据，有主键，但是对于同样主键的属性会发生缓慢变化，如交易、订单状态与时间会根据业务发生变更。</p>
<ol start="3" style="list-style-type: decimal">
<li>维表</li>
</ol>
<p>维表包括维度与维度属性数据，如用户表、商品表。</p>
<ol start="4" style="list-style-type: decimal">
<li>Merge 全量表</li>
</ol>
<p>Merge 全量表包括业务过程性数据或者维表数据。由于数据本身有新增的或者发生状态变更，对于同样主键的数据可能会保留多份，因此可以对这些数据根据主键进行 Merge 操作，主键对应的属性只会保留最新状态，历史状态保留在前一天分区 中。例如，用户表、交易表等都可以进行 Merge 操作。</p>
<ol start="5" style="list-style-type: decimal">
<li>ETL 临时表</li>
</ol>
<p>ETL 临时表是指 ETL 处理过程中产生的临时表数据，一般不建议保留，最多7天。</p>
<ol start="6" style="list-style-type: decimal">
<li>TT 临时数据</li>
</ol>
<p>TT 拉取的数据和 DbSync 产生的临时数据最终会流转到 DS 层，ODS 层数据作为原始数据保留下来，从而使得 TT&amp;DbSync 上游数据成为临时数据。这类数据不建议保留很长时间，生命周期默认设置为 93天，可以根据实际情况适当减少保留天数。</p>
<ol start="7" style="list-style-type: decimal">
<li>普通全量表</li>
</ol>
<p>很多小业务数据或者产品数据，BI一般是直接全量拉取，这种方式效率快，对存储压力也不是很大，而且表保留很长时间，可以根据历史数据等级确定保留策略。</p>
<p>通过上述历史数据等级划分与表类型划分，生成相应的生命周期管理矩阵，如下表所示：</p>
<p><img src="https://picx.zhimg.com/80/v2-b7b94129efb6e3ac59ec2c0a882c74ac_1440w.png" /></p>
</div>
</div>
</div>
<div id="数仓各层开发规范" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> 数仓各层开发规范<a href="数仓规范建设指南.html#数仓各层开发规范" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="ods层设计规范" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> ODS层设计规范<a href="数仓规范建设指南.html#ods层设计规范" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="同步规范" class="section level4 hasAnchor" number="8.2.1.1">
<h4><span class="header-section-number">8.2.1.1</span> 同步规范：<a href="数仓规范建设指南.html#同步规范" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>一个系统源表只允许同步一次；</li>
<li>全量初始化同步和增量同步处理逻辑要清晰；</li>
<li>以统计日期和时间进行分区存储；</li>
<li>目标表字段在源表不存在时要自动填充处理。</li>
</ul>
</div>
<div id="表分类与生命周期" class="section level4 hasAnchor" number="8.2.1.2">
<h4><span class="header-section-number">8.2.1.2</span> 表分类与生命周期：<a href="数仓规范建设指南.html#表分类与生命周期" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>ods流水全量表：</p>
<ul>
<li>不可再生的永久保存；</li>
<li>日志可按留存要求；</li>
<li>按需设置保留特殊日期数据；</li>
<li>按需设置保留特殊月份数据；</li>
</ul>
<p>ods镜像型全量表：</p>
<ul>
<li>推荐按天存储；</li>
<li>对历史变化进行保留；</li>
<li>最新数据存储在最大分区；</li>
<li>历史数据按需保留；</li>
</ul>
<p>ods增量数据：</p>
<ul>
<li>推荐按天存储；</li>
<li>有对应全量表的，建议只保留14天数据；</li>
<li>无对应全量表的，永久保留；</li>
</ul>
<p>ods的etl过程中的临时表：</p>
<ul>
<li>推荐按需保留；</li>
<li>最多保留7天；</li>
<li>建议用完即删，下次使用再生成；</li>
</ul>
<p>BDSync非去重数据：</p>
<ul>
<li>通过中间层保留，默认用完即删，不建议保留。</li>
</ul>
</div>
<div id="数据质量" class="section level4 hasAnchor" number="8.2.1.3">
<h4><span class="header-section-number">8.2.1.3</span> 数据质量：<a href="数仓规范建设指南.html#数据质量" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>全量表必须配置唯一性字段标识；</li>
<li>对分区空数据进行监控；</li>
<li>对枚举类型字段，进行枚举值变化和分布监控；</li>
<li>ods表数据量级和记录数做环比监控；</li>
<li>ods全表都必须要有注释；</li>
</ul>
</div>
</div>
</div>
<div id="公共维度层设计规范" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> 公共维度层设计规范<a href="数仓规范建设指南.html#公共维度层设计规范" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="设计准则" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> 设计准则<a href="数仓规范建设指南.html#设计准则" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="一致性" class="section level4 hasAnchor" number="8.3.1.1">
<h4><span class="header-section-number">8.3.1.1</span> 一致性<a href="数仓规范建设指南.html#一致性" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>共维度在不同的物理表中的字段名称、数据类型、数据内容必须保持一致（历史原因不一致，要做好版本控制）</p>
</div>
<div id="维度的组合与拆分" class="section level4 hasAnchor" number="8.3.1.2">
<h4><span class="header-section-number">8.3.1.2</span> 维度的组合与拆分<a href="数仓规范建设指南.html#维度的组合与拆分" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>组合原则：</p>
<p>将维度与关联性强的字段进行组合，一起查询，一起展示，两个维度必须具有天然的关系，如：商品的基本属性和所属品牌。</p>
<p>无相关性：如一些使用频率较小的杂项维度，可以构建一个集合杂项维度的特殊属性。</p>
<p>行为维度：经过计算的度量，但下游当维度处理，例：点击量 0-1000,100-1000等，可以做聚合分类。</p>
<p>拆分与冗余：</p>
<p>针对重要性，业务相关性、源、使用频率等可分为核心表、扩展表。
数据记录较大的维度，可以适当冗余一些子集。</p>
</div>
<div id="存储及生命周期管理" class="section level4 hasAnchor" number="8.3.1.3">
<h4><span class="header-section-number">8.3.1.3</span> 存储及生命周期管理<a href="数仓规范建设指南.html#存储及生命周期管理" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>建议按天分区。</p>
<ul>
<li>3个月内最大访问跨度&lt;=4天时，建议保留最近7天分区；</li>
<li>3个月内最大访问跨度&lt;=12天时，建议保留最近15天分区；</li>
<li>3个月内最大访问跨度&lt;=30天时，建议保留最近33天分区；</li>
<li>3个月内最大访问跨度&lt;=90天时，建议保留最近120天分区；</li>
<li>3个月内最大访问跨度&lt;=180天时，建议保留最近240天分区；</li>
<li>3个月内最大访问跨度&lt;=300天时，建议保留最近400天分区；</li>
</ul>
</div>
</div>
<div id="dwd明细层设计规范" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> DWD明细层设计规范<a href="数仓规范建设指南.html#dwd明细层设计规范" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="存储及生命周期管理-1" class="section level4 hasAnchor" number="8.3.2.1">
<h4><span class="header-section-number">8.3.2.1</span> 存储及生命周期管理<a href="数仓规范建设指南.html#存储及生命周期管理-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>建议按天分区。</p>
<ul>
<li>3个月内最大访问跨度&lt;=4天时，建议保留最近7天分区；</li>
<li>3个月内最大访问跨度&lt;=12天时，建议保留最近15天分区；</li>
<li>3个月内最大访问跨度&lt;=30天时，建议保留最近33天分区；</li>
<li>3个月内最大访问跨度&lt;=90天时，建议保留最近120天分区；</li>
<li>3个月内最大访问跨度&lt;=180天时，建议保留最近240天分区；</li>
<li>3个月内最大访问跨度&lt;=300天时，建议保留最近400天分区；</li>
</ul>
</div>
<div id="事务型事实表设计准则" class="section level4 hasAnchor" number="8.3.2.2">
<h4><span class="header-section-number">8.3.2.2</span> 事务型事实表设计准则<a href="数仓规范建设指南.html#事务型事实表设计准则" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>基于数据应用需求的分析设计事务型事实表，结合下游较大的针对某个业务过程和分析指标需求，可考虑基于某个事件过程构建事务型实时表；</li>
<li>一般选用事件的发生日期或时间作为分区字段，便于扫描和裁剪；</li>
<li>冗余子集原则，有利于降低后续IO开销；</li>
<li>明细层事实表维度退化，减少后续使用join成本。</li>
</ul>
</div>
<div id="周期快照事实表" class="section level4 hasAnchor" number="8.3.2.3">
<h4><span class="header-section-number">8.3.2.3</span> 周期快照事实表<a href="数仓规范建设指南.html#周期快照事实表" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>周期快照事实表中的每行汇总了发生在某一标准周期，如某一天、某周、某月的多个度量事件。</li>
<li>粒度是周期性的，不是个体的事务。</li>
<li>通常包含许多事实，因为任何与事实表粒度一致的度量事件都是被允许的。</li>
</ul>
</div>
<div id="累积快照事实表" class="section level4 hasAnchor" number="8.3.2.4">
<h4><span class="header-section-number">8.3.2.4</span> 累积快照事实表<a href="数仓规范建设指南.html#累积快照事实表" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>多个业务过程联合分析而构建的事实表，如采购单的流转环节。</li>
<li>用于分析事件时间和时间之间的间隔周期。</li>
<li>少量的且当前事务型不支持的，如关闭、发货等相关的统计。</li>
</ul>
</div>
</div>
<div id="dws公共汇总层设计规范" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> DWS公共汇总层设计规范<a href="数仓规范建设指南.html#dws公共汇总层设计规范" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>数据仓库的性能是数据仓库建设是否成功的重要标准之一。聚集主要是通过汇总明细粒度数据来获得改进查询性能的效果。通过访问聚集数据，可以减少数据库在响应查询时必须执行的工作量，能够快速响应用户的查询，同时有利于减少不同用访问明细数据带来的结果不一致问题。</p>
<div id="聚集的基本原则" class="section level4 hasAnchor" number="8.3.3.1">
<h4><span class="header-section-number">8.3.3.1</span> 聚集的基本原则<a href="数仓规范建设指南.html#聚集的基本原则" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>一致性。聚集表必须提供与查询明细粒度数据一致的查询结果。</li>
<li>避免单一表设计。不要在同一个表中存储不同层次的聚集数据。</li>
<li>聚集粒度可不同。聚集并不需要保持与原始明细粒度数据一样的粒度，聚集只关心所需要查询的维度。</li>
</ul>
</div>
<div id="聚集的基本步骤" class="section level4 hasAnchor" number="8.3.3.2">
<h4><span class="header-section-number">8.3.3.2</span> 聚集的基本步骤<a href="数仓规范建设指南.html#聚集的基本步骤" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>第一步：确定聚集维度</p>
<p>在原始明细模型中会存在多个描述事实的维度，如日期、商品类别、卖家等，这时候需要确定根据什么维度聚集，如果只关心商品的交易额情况，那么就可以根据商品维度聚集数据。</p>
<p>第二步：确定一致性上钻</p>
<p>这时候要关心是按月汇总还是按天汇总，是按照商品汇总还是按照类目汇总，如果按照类目汇总，还需要关心是按照大类汇总还是小类汇总。当然，我们要做的只是了解用户需要什么，然后按照他们想要的进行聚集。</p>
<p>第三步：确定聚集事实</p>
<p>在原始明细模型中可能会有多个事实的度量，比如在交易中有交易额、交易数量等，这时候要明确是按照交易额汇总还是按照成交数量汇总。</p>
</div>
<div id="公共汇总层设计原则" class="section level4 hasAnchor" number="8.3.3.3">
<h4><span class="header-section-number">8.3.3.3</span> 公共汇总层设计原则<a href="数仓规范建设指南.html#公共汇总层设计原则" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>除了聚集基本的原则外，公共汇总层还必须遵循以下原则：</p>
<ul>
<li>数据公用性。汇总的聚集会有第三者使用吗？基于某个维度的聚集是不是经常用于数据分析中？如果答案是肯定的，那么就有必要把明细数据经过汇总沉淀到聚集表中。</li>
<li>不跨数据域。数据域是在较高层次上对数据进行分类聚集的抽象。如以业务</li>
<li>区分统计周期。在表的命名上要能说明数据的统计周期，如 _Id 表示最近1天，_td 表示截至当天，_nd 表示最近N天。</li>
</ul>
</div>
</div>
</div>
<div id="数仓命名规范" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> 数仓命名规范<a href="数仓规范建设指南.html#数仓命名规范" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="词根设计规范" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> 词根设计规范<a href="数仓规范建设指南.html#词根设计规范" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>词根属于数仓建设中的规范，属于元数据管理的范畴，现在把这个划到数据治理的一部分。完整的数仓建设是包含数据治理的，只是现在谈到数仓偏向于数据建模， 而谈到数据治理，更多的是关于数据规范、数据管理。</p>
<p>表命名，其实在很大程度上是对元数据描述的一种体现，表命名规范越完善，我 们能从表名获取到的信息就越多。比如：一部分业务是关于货架的，英文名是：rack， rack 就是一个词根，那我们就在所有的表、字段等用到的地方都叫 rack，不要叫成 别的什么。这就是词根的作用，用来统一命名，表达同一个含义。</p>
<p>指标体系中有很多“率”的指标，都可以拆解成 XXX+率，率可以叫 rate，那我 们所有的指标都叫做 XXX+rate。</p>
<p>词根：可以用来统一表名、字段名、主题域名等等。</p>
<p>举例：以流程图的方式来展示，更加直观和易懂，本图侧重 dwm 层表的命名 规范，其余命名是类似的道理：</p>
<p><img src="https://picx.zhimg.com/80/v2-2c02c1dc4f120a867b73710205752931_1440w.png" /></p>
<p>第一个判断条件是该表的用途，是中间表、原始日志还是业务展示用的表 如果该表被判断为中间表，就会走入下一个判断条件：表是否有 group 操作 通过是否有 group 操作来判断该表该划分在 dwd 层还是 dwm 和 dws 层 如果不是 dwd 层，则需要判断该表是否是多个行为的汇总表（即宽表） 最后再分别填上事业群、部门、业务线、自定义名称和更新频率等信息即可。</p>
<ul>
<li>分层：表的使用范围</li>
<li>事业群和部门：生产该表或者该数据的团队</li>
<li>业务线：表明该数据是哪个产品或者业务线相关</li>
<li>主题域：分析问题的角度，对象实体</li>
<li>自定义：一般会尽可能多描述该表的信息，比如活跃表、留存表等</li>
<li>更新周期：比如说天级还是月级更新</li>
</ul>
</div>
<div id="数仓表的命名规范如下" class="section level3 hasAnchor" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> 数仓表的命名规范如下：<a href="数仓规范建设指南.html#数仓表的命名规范如下" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="数仓层次" class="section level4 hasAnchor" number="8.4.2.1">
<h4><span class="header-section-number">8.4.2.1</span> 数仓层次:<a href="数仓规范建设指南.html#数仓层次" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>公用维度：dim</p></li>
<li><p>DM层：dm</p></li>
<li><p>ODS层：ods</p></li>
<li><p>DWD层：dwd</p></li>
<li><p>DWS层：dws</p></li>
</ul>
</div>
<div id="周期数据范围" class="section level4 hasAnchor" number="8.4.2.2">
<h4><span class="header-section-number">8.4.2.2</span> 周期/数据范围：<a href="数仓规范建设指南.html#周期数据范围" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>日快照：d</p></li>
<li><p>增量：i</p></li>
<li><p>全量：f</p></li>
<li><p>周：w</p></li>
<li><p>拉链表：l</p></li>
<li><p>非分区全量表：a</p></li>
</ul>
</div>
</div>
<div id="表命名规范" class="section level3 hasAnchor" number="8.4.3">
<h3><span class="header-section-number">8.4.3</span> 表命名规范<a href="数仓规范建设指南.html#表命名规范" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="常规表" class="section level4 hasAnchor" number="8.4.3.1">
<h4><span class="header-section-number">8.4.3.1</span> 常规表<a href="数仓规范建设指南.html#常规表" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>常规表是我们需要固化的表，是正式使用的表，是目前一段时间内需要去维护去 完善的表。</p>
<p>规范：分层前缀[dwd|dws|ads]_部门_业务域_主题域_XXX_更新周期|数据范围</p>
<p>业务域、主题域我们都可以用词根的方式枚举清楚，不断完善。</p>
<p>更新周期主要的是时间粒度、日、月、年、周等。</p>
</div>
<div id="中间表" class="section level4 hasAnchor" number="8.4.3.2">
<h4><span class="header-section-number">8.4.3.2</span> 中间表<a href="数仓规范建设指南.html#中间表" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>中间表一般出现在 Job 中，是 Job 中临时存储的中间数据的表，中间表的作 用域只限于当前 Job 执行过程中，Job 一旦执行完成，该中间表的使命就完 成了，是可以删除的（按照自己公司的场景自由选择，以前公司会保留几天 的中间表数据，用来排查问题）。</p>
<p>规范：mid_table_name_[0~9|dim]</p>
<p>table_name 是我们任务中目标表的名字，通常来说一个任务只有一个目标表。这里加上表名，是为了防止自由发挥的时候表名冲突，而末尾大家可以选择自由发挥，起一些有意义的名字，或者简单粗暴，使用数字代替，各有优劣吧，谨慎选择。</p>
<p>通常会遇到需要补全维度的表，这里使用 dim 结尾。</p>
<p>如果要保留历史的中间表，可以加上日期或者时间戳。</p>
</div>
<div id="临时表" class="section level4 hasAnchor" number="8.4.3.3">
<h4><span class="header-section-number">8.4.3.3</span> 临时表<a href="数仓规范建设指南.html#临时表" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>临时表是临时测试的表，是临时使用一次的表，就是暂时保存下数据看看，后续一般不再使用的表，是可以随时删除的表。</p>
<p>规范：tmp_xxx</p>
<p>只要加上 tmp 开头即可，其他名字随意，注意 tmp 开头的表不要用来实际使用，只是测试验证而已。</p>
</div>
<div id="维度表-1" class="section level4 hasAnchor" number="8.4.3.4">
<h4><span class="header-section-number">8.4.3.4</span> 维度表<a href="数仓规范建设指南.html#维度表-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>维度表是基于底层数据，抽象出来的描述类的表。维度表可以自动从底层表抽象出来，也可以手工来维护。</p>
<p>规范：dim_xxx</p>
<p>维度表，统一以 dim 开头，后面加上，对该指标的描述。</p>
</div>
<div id="手工表" class="section level4 hasAnchor" number="8.4.3.5">
<h4><span class="header-section-number">8.4.3.5</span> 手工表<a href="数仓规范建设指南.html#手工表" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>手工表是手工维护的表，手工初始化一次之后，一般不会自动改变，后面变更，也是手工来维护。</p>
<p>一般来说，手工的数据粒度是偏细的，所以暂时统一放在 dwd 层，后面如果有目标值或者其他类型手工数据，再根据实际情况分层。</p>
<p>规范：dwd_业务域_manual_xxx</p>
<p>手工表，增加特殊的主题域，manual，表示手工维护表。</p>
</div>
</div>
<div id="指标命名规范" class="section level3 hasAnchor" number="8.4.4">
<h3><span class="header-section-number">8.4.4</span> 指标命名规范<a href="数仓规范建设指南.html#指标命名规范" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>所有单词小写</li>
<li>单词之间下划线分割（反例：appName 或 AppName）</li>
<li>可读性优于长度 (词根，避免出现同一个指标，命名一致性)</li>
<li>禁止使用 sql 关键字，如字段名与关键字冲突时 +col</li>
<li>数量字段后缀 _cnt 等标识…</li>
<li>金额字段后缀 _price 标识</li>
<li>天分区使用字段 dt，格式统一（yyyymmdd 或 yyyy-mm-dd）</li>
<li>小时分区使用字段 hh，范围（00-23）</li>
<li>分钟分区使用字段 mi，范围（00-59）</li>
<li>布尔类型标识：is_{业务}，不允许出现空值</li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="搭建数据仓库.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="其他一些内容.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/07-references.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
